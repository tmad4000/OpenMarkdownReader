<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; style-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com; script-src 'self' https://cdnjs.cloudflare.com">
  <title>OpenMarkdownReader</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css" media="(prefers-color-scheme: light)">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css" media="(prefers-color-scheme: dark)">
  <link rel="icon" type="image/svg+xml" href="icon.svg">
</head>
<body>
  <div class="titlebar" id="titlebar">
    <button id="sidebar-toggle" class="sidebar-toggle" title="Toggle Sidebar (⌘B)">
      <svg viewBox="0 0 20 20" fill="currentColor" width="16" height="16">
        <path d="M2 4.5A1.5 1.5 0 013.5 3h13A1.5 1.5 0 0118 4.5v11a1.5 1.5 0 01-1.5 1.5h-13A1.5 1.5 0 012 15.5v-11zM3.5 4a.5.5 0 00-.5.5v11a.5.5 0 00.5.5H7V4H3.5zM8 4v12h8.5a.5.5 0 00.5-.5v-11a.5.5 0 00-.5-.5H8z"/>
      </svg>
    </button>
    <div class="tab-bar-wrapper">
      <div id="tab-bar" class="tab-bar"></div>
      <button id="new-tab-btn" class="new-tab-btn" title="New Tab (⌘T)">+</button>
    </div>
    <div class="titlebar-drag-spacer"></div>
    <div id="watch-indicator" class="watch-indicator hidden" title="Watching for file changes">
      <svg viewBox="0 0 16 16" fill="currentColor" width="14" height="14">
        <path d="M8 2C4.5 2 1.55 4.13 0 7.5 1.55 10.87 4.5 13 8 13s6.45-2.13 8-5.5C14.45 4.13 11.5 2 8 2zM8 11c-1.93 0-3.5-1.57-3.5-3.5S6.07 4 8 4s3.5 1.57 3.5 3.5S9.93 11 8 11zm0-5.5c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/>
      </svg>
      Watching
    </div>
    <button id="save-btn" class="save-btn hidden" title="Save (⌘S)">
      <svg viewBox="0 0 16 16" fill="currentColor" width="14" height="14">
        <path d="M11.013 2.513a1.75 1.75 0 012.475 2.474l-6.5 6.5a.75.75 0 01-.354.198l-3.5 1a.75.75 0 01-.928-.928l1-3.5a.75.75 0 01.198-.354l6.5-6.5a.25.25 0 00-.354-.354l-6.5 6.5-.086.302-.302.086 6.5-6.5z"/>
        <path d="M3.5 5.75v8.5c0 .414.336.75.75.75h8.5a.75.75 0 00.75-.75v-8.5a.75.75 0 00-.75-.75h-1.5a.75.75 0 010-1.5h1.5A2.25 2.25 0 0115 5.75v8.5A2.25 2.25 0 0112.75 16h-8.5A2.25 2.25 0 012 14.25v-8.5A2.25 2.25 0 014.25 3.5h1.5a.75.75 0 010 1.5h-1.5a.75.75 0 00-.75.75z"/>
      </svg>
      Save
    </button>
    <button id="toc-toggle-btn" class="toc-toggle-btn" title="Toggle Table of Contents">
      <svg viewBox="0 0 16 16" fill="currentColor" width="14" height="14">
        <path d="M2 4a1 1 0 100-2 1 1 0 000 2zm3.75-1.5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zM3 8a1 1 0 11-2 0 1 1 0 012 0zm-1 6a1 1 0 100-2 1 1 0 000 2z"/>
      </svg>
    </button>
    <button id="edit-toggle-btn" class="edit-toggle-btn" title="Toggle Edit Mode (⌘E)">
      <svg viewBox="0 0 16 16" fill="currentColor" width="14" height="14">
        <path d="M11.013 1.427a1.75 1.75 0 012.474 0l1.086 1.086a1.75 1.75 0 010 2.474l-8.61 8.61c-.21.21-.47.364-.756.445l-3.251.93a.75.75 0 01-.927-.928l.929-3.25c.081-.286.235-.547.445-.758l8.61-8.61zm1.414 1.06a.25.25 0 00-.354 0L10.811 3.75l1.439 1.44 1.263-1.263a.25.25 0 000-.354l-1.086-1.086zM11.189 6.25L9.75 4.81l-6.286 6.287a.25.25 0 00-.064.108l-.558 1.953 1.953-.558a.249.249 0 00.108-.064l6.286-6.286z"/>
      </svg>
    </button>
  </div>

  <div class="main-container">
    <!-- Sidebar -->
    <div id="sidebar" class="sidebar hidden">
      <div class="sidebar-header">
        <span class="sidebar-title">Files</span>
        <div class="sidebar-header-buttons">
          <button id="sidebar-new-file-btn" class="sidebar-btn" title="New File (⌘N)">
            <svg viewBox="0 0 16 16" fill="currentColor" width="14" height="14">
              <path d="M8 0a.75.75 0 01.75.75v6.5h6.5a.75.75 0 010 1.5h-6.5v6.5a.75.75 0 01-1.5 0v-6.5h-6.5a.75.75 0 010-1.5h6.5V.75A.75.75 0 018 0z"/>
            </svg>
          </button>
          <button id="open-folder-btn" class="sidebar-btn" title="Open Folder (⌘⇧O)">
            <svg viewBox="0 0 20 20" fill="currentColor" width="14" height="14">
              <path d="M3.75 3A1.75 1.75 0 002 4.75v10.5c0 .966.784 1.75 1.75 1.75h12.5A1.75 1.75 0 0018 15.25v-8.5A1.75 1.75 0 0016.25 5H9.414a.25.25 0 01-.177-.073l-.896-.897A1.75 1.75 0 006.586 3.5H3.75z"/>
            </svg>
          </button>
        </div>
      </div>
      <div id="file-tree" class="file-tree"></div>
    </div>

    <!-- Main content area -->
    <div class="content-area">
      <div id="drop-zone" class="drop-zone">
        <div class="welcome">
          <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
          </svg>
          <h1>OpenMarkdownReader</h1>
          <p>Drop a file here or</p>
          <div class="welcome-buttons">
            <button id="new-file-btn" class="welcome-btn" title="New File (⌘N)">
              <svg viewBox="0 0 16 16" fill="currentColor" width="16" height="16">
                <path d="M8 0a.75.75 0 01.75.75v6.5h6.5a.75.75 0 010 1.5h-6.5v6.5a.75.75 0 01-1.5 0v-6.5h-6.5a.75.75 0 010-1.5h6.5V.75A.75.75 0 018 0z"/>
              </svg>
              New File
            </button>
            <button id="open-btn" class="welcome-btn welcome-btn-secondary" title="Open File or Folder (⌘O)">
              <svg viewBox="0 0 16 16" fill="currentColor" width="16" height="16">
                <path d="M1.75 2.5a.25.25 0 00-.25.25v10.5c0 .138.112.25.25.25h12.5a.25.25 0 00.25-.25v-8.5a.25.25 0 00-.25-.25H7.414a.25.25 0 01-.177-.073l-.896-.897A.75.75 0 005.586 3H1.75z"/>
              </svg>
              Open...
            </button>
          </div>
          <div id="recent-files-section" class="recent-files-section hidden">
            <p class="recent-files-title">Recent</p>
            <div id="recent-files-list" class="recent-files-list"></div>
          </div>
          <p class="hint">⌘N new | ⌘O open file or folder | ⌘P search</p>
        </div>
      </div>

      <div id="content" class="content hidden">
        <div id="editor-container" class="editor-container hidden">
          <textarea id="editor" class="editor" spellcheck="false"></textarea>
        </div>
        <article id="markdown-body" class="markdown-body"></article>
        <!-- CSV Table View -->
        <div id="csv-view" class="csv-view hidden">
          <div class="csv-toolbar">
            <span class="csv-label">CSV Table View</span>
            <button id="csv-toggle-raw" class="csv-toggle-btn" title="View as raw text">
              <svg viewBox="0 0 16 16" fill="currentColor" width="14" height="14">
                <path d="M4 1.75C4 .784 4.784 0 5.75 0h5.586c.464 0 .909.184 1.237.513l2.914 2.914c.329.328.513.773.513 1.237v8.586A1.75 1.75 0 0114.25 15h-9a.75.75 0 010-1.5h9a.25.25 0 00.25-.25V6H12.5a.25.25 0 01-.25-.25V2.5H5.75a.25.25 0 00-.25.25v2.5a.75.75 0 01-1.5 0V1.75z"/>
                <path d="M0 10.75C0 9.784.784 9 1.75 9h5.5c.966 0 1.75.784 1.75 1.75v3.5A1.75 1.75 0 017.25 16h-5.5A1.75 1.75 0 010 14.25v-3.5zm1.75-.25a.25.25 0 00-.25.25v3.5c0 .138.112.25.25.25h5.5a.25.25 0 00.25-.25v-3.5a.25.25 0 00-.25-.25h-5.5z"/>
              </svg>
              Raw
            </button>
          </div>
          <div id="csv-table-container" class="csv-table-container"></div>
        </div>
      </div>

      <!-- Table of Contents Panel -->
      <div id="toc-panel" class="toc-panel hidden">
        <div class="toc-header">
          <span class="toc-title">Contents</span>
          <button id="toc-close" class="toc-close-btn" title="Close">
            <svg viewBox="0 0 16 16" fill="currentColor" width="12" height="12">
              <path d="M3.72 3.72a.75.75 0 011.06 0L8 6.94l3.22-3.22a.75.75 0 111.06 1.06L9.06 8l3.22 3.22a.75.75 0 11-1.06 1.06L8 9.06l-3.22 3.22a.75.75 0 01-1.06-1.06L6.94 8 3.72 4.78a.75.75 0 010-1.06z"/>
            </svg>
          </button>
        </div>
        <nav id="toc-content" class="toc-content"></nav>
      </div>
    </div>
  </div>

  <!-- Find Bar -->
  <div id="find-bar" class="find-bar hidden">
    <div class="find-bar-input-wrapper">
      <input type="text" id="find-input" class="find-input" placeholder="Find" autocomplete="off">
      <div id="find-count" class="find-count hidden">0/0</div>
    </div>
    <div class="find-bar-buttons">
      <button id="find-prev-btn" class="find-btn" title="Previous Match (Shift+Enter)">
        <svg viewBox="0 0 16 16" fill="currentColor" width="14" height="14">
          <path d="M8 3.5a.5.5 0 01.354.146l4 4a.5.5 0 01-.708.708L8.5 5.207V12.5a.5.5 0 01-1 0V5.207L4.354 8.354a.5.5 0 11-.708-.708l4-4A.5.5 0 018 3.5z"/>
        </svg>
      </button>
      <button id="find-next-btn" class="find-btn" title="Next Match (Enter)">
        <svg viewBox="0 0 16 16" fill="currentColor" width="14" height="14">
          <path d="M8 12.5a.5.5 0 01-.354-.146l-4-4a.5.5 0 11.708-.708L7.5 10.793V3.5a.5.5 0 011 0v7.293l3.146-3.147a.5.5 0 01.708.708l-4 4a.5.5 0 01-.354.146z"/>
        </svg>
      </button>
      <button id="find-close-btn" class="find-btn find-close-btn" title="Close (Esc)">
        <svg viewBox="0 0 16 16" fill="currentColor" width="14" height="14">
          <path d="M3.72 3.72a.75.75 0 011.06 0L8 6.94l3.22-3.22a.75.75 0 111.06 1.06L9.06 8l3.22 3.22a.75.75 0 11-1.06 1.06L8 9.06l-3.22 3.22a.75.75 0 01-1.06-1.06L6.94 8 3.72 4.78a.75.75 0 010-1.06z"/>
        </svg>
      </button>
    </div>
  </div>

  <!-- Command Palette / File Search -->
  <div id="command-palette" class="command-palette hidden">
    <div class="command-palette-backdrop"></div>
    <div class="command-palette-modal">
      <input type="text" id="command-palette-input" class="command-palette-input" placeholder="Search files..." autocomplete="off">
      <div id="command-palette-results" class="command-palette-results"></div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/12.0.0/marked.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script src="renderer.js"></script>
</body>
</html>
